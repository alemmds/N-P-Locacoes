<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Cadastro</title>
    <style>
        .collapsed {
            display: none;
        }
        .expand-button {
            background-color: #4CAF50; /* Cor do botão de expandir/minimizar */
            color: white;
            padding: 10px;
            cursor: pointer;
            border: none;
            border-radius: 5px;
            margin-bottom: 5px;
        }
        .details {
            background-color: #f9f9f9;
            padding: 10px;
            border: 1px solid #ccc;
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Seção de Máquinas (Exemplo) -->
        <section id="maquinasSection" class="section">
            <h2>Cadastro de Máquinas</h2>
            <form id="formMaquina" onsubmit="addOrUpdateItem('maquinasList', 'nomeMaquina', ['serieMaquina', 'anosUsoMaquina', 'horimetroMaquina', 'ultimaManutencaoMaquina', 'dataEntradaMaquina']); return false;">
                <label>Nome da Máquina:</label><input type="text" id="nomeMaquina"><br>
                <label>Série:</label><input type="text" id="serieMaquina"><br>
                <label>Anos de Uso:</label><input type="number" id="anosUsoMaquina"><br>
                <label>Horímetro:</label><input type="number" id="horimetroMaquina"><br>
                <label>Última Manutenção:</label><input type="date" id="ultimaManutencaoMaquina"><br>
                <label>Data de Entrada:</label><input type="date" id="dataEntradaMaquina"><br>
                <div class="buttons">
                    <button type="submit">Confirmar</button>
                    <button type="button" onclick="showList('maquinasList')">Listar</button>
                    <button type="button" onclick="goBack('maquinasSection')">Voltar</button>
                </div>
            </form>
            <!-- Lista de Máquinas -->
            <div id="maquinasList"></div>
        </section>
    </div>

    <script>
        let editIndex = -1;

        function addOrUpdateItem(listId, itemNameId, additionalIds) {
            const list = document.getElementById(listId);
            const itemName = document.getElementById(itemNameId).value;
            const additionalData = additionalIds.map(id => document.getElementById(id).value);

            if (!itemName || additionalData.includes('')) return; // Garante que todos os campos estejam preenchidos

            const itemHtml = `
                <p>Nome: ${itemName}</p>
                <p>Série: ${additionalData[0]}</p>
                <p>Anos de uso: ${additionalData[1]}</p>
                <p>Horímetro: ${additionalData[2]}</p>
                <p>Última manutenção: ${additionalData[3]}</p>
                <p>Data de entrada: ${additionalData[4]}</p>
            `;

            if (editIndex === -1) {
                const button = document.createElement('button');
                button.classList.add('expand-button');
                button.innerHTML = itemName;
                button.onclick = function() {
                    toggleDetails(`item-${list.children.length / 2}`);
                };

                const detailsDiv = document.createElement('div');
                detailsDiv.id = `item-${list.children.length / 2}`;
                detailsDiv.classList.add('details', 'collapsed');
                detailsDiv.innerHTML = itemHtml + `
                    <button onclick="editItem(${list.children.length / 2}, '${itemNameId}', ${JSON.stringify(additionalIds)})">Alterar</button>
                    <button onclick="deleteItem(this)">Excluir</button>
                `;

                list.appendChild(button);
                list.appendChild(detailsDiv);
            } else {
                const button = list.children[editIndex * 2];
                const detailsDiv = document.getElementById(`item-${editIndex}`);
                button.innerHTML = itemName;
                detailsDiv.innerHTML = itemHtml + `
                    <button onclick="editItem(${editIndex}, '${itemNameId}', ${JSON.stringify(additionalIds)})">Alterar</button>
                    <button onclick="deleteItem(this)">Excluir</button>
                `;
                editIndex = -1;
            }

            document.getElementById(itemNameId).value = '';
            additionalIds.forEach(id => document.getElementById(id).value = '');
        }

        function toggleDetails(itemId) {
            const details = document.getElementById(itemId);
            details.classList.toggle('collapsed');
        }

        function editItem(index, itemNameId, additionalIds) {
            const list = document.getElementById('maquinasList');
            const itemButton = list.children[index * 2];
            const details = document.getElementById(`item-${index}`);

            document.getElementById(itemNameId).value = itemButton.innerHTML;
            const values = details.innerText.split('\n').map(line => line.split(': ')[1]);
            additionalIds.forEach((id, i) => {
                document.getElementById(id).value = values[i];
            });

            editIndex = index;
        }

        function deleteItem(button) {
            const itemButton = button.parentElement.previousSibling;
            itemButton.remove();
            button.parentElement.remove();
        }

        function goBack(sectionId) {
            document.getElementById(sectionId).style.display = 'none';
        }

        function showList(listId) {
            const list = document.getElementById(listId);
            list.classList.toggle('collapsed');
        }
    </script>
</body>
</html>